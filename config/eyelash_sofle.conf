# Copyright (c) 2024 The ZMK Contributors
#
# SPDX-License-Identifier: MIT

# --- Core ZMK Options ---
CONFIG_ZMK_KEYBOARD_NAME="Eyelash Sofle (Custom)"
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=3600000 # 1 hour (user value)
CONFIG_PM_DEVICE_RUNTIME=y # For better power management with peripherals

# --- Debounce ---
CONFIG_ZMK_KSCAN_DEBOUNCE_PRESS_MS=5
CONFIG_ZMK_KSCAN_DEBOUNCE_RELEASE_MS=5

# --- Bluetooth ---
CONFIG_ZMK_BLE=y
# CONFIG_ZMK_BLE_PASSKEY_ENTRY=y # Uncomment if you want to confirm passkey on host
CONFIG_ZMK_BLE_CONSUMER_REPORT_WORK_DELAY_MS=0

# --- USB ---
CONFIG_ZMK_USB=y
CONFIG_ZMK_USB_BOOTLOADER_NO_CONFIRMATION=y
# CONFIG_ZMK_USB_LOGGING=y # Uncomment for debugging

# --- Outputs ---
CONFIG_ZMK_OUTPUTS=y # For Bluetooth/USB output selection

# --- RGB Underglow ---
CONFIG_ZMK_RGB_UNDERGLOW=y
CONFIG_WS2812_STRIP=y # Assuming WS2812 LEDs
CONFIG_ZMK_RGB_UNDERGLOW_AUTO_OFF_IDLE=y # Turn off RGB when idle
CONFIG_ZMK_RGB_UNDERGLOW_AUTO_OFF_USB=y  # Turn off RGB when on USB (if desired for power saving)


# --- Display (for nice_view shields in build.yaml) ---
CONFIG_ZMK_DISPLAY=y
CONFIG_SSD1306=y # Common driver for nice_view, ensure this matches your display
CONFIG_ZMK_DISPLAY_STATUS_SCREEN_BUILT_IN=y
CONFIG_ZMK_DISPLAY_HIDE_LOGO=y


# --- Encoders ---
CONFIG_ZMK_EC11=y
CONFIG_EC11=y # Ensure this is enabled if your DTS uses "alps,ec11" compatible
CONFIG_ZMK_SENSOR_ROTATE_KEY_PRESS_MAX_BINDINGS=3 # Default is 2, need 3 for press action

# --- Joystick ---
CONFIG_ZMK_JOYSTICK=y
CONFIG_ZMK_JOYSTICK_POINTING_DEVICE=y # Map axes to keys/macros via sensor bindings
CONFIG_ZMK_JOYSTICK_ANALOG_TRIGGER_THRESHOLD=30 # Adjust sensitivity as needed
CONFIG_ADC=y # Required for analog joystick input

# --- Mouse Keys ---
CONFIG_ZMK_MOUSE=y

# --- Behaviors ---
CONFIG_ZMK_BEHAVIORS_QUEUE_SIZE=64 # Increased for complex setups
CONFIG_ZMK_BEHAVIORS_HELD_DELAY_MS=0
CONFIG_ZMK_BEHAVIORS_QUICK_TAP_MS=200 # Global quick tap, tapping-term-ms in behavior definition takes precedence

# Hold-Tap specific configurations
CONFIG_ZMK_BEHAVIORS_HOLD_TAP_QUEUED=y
CONFIG_ZMK_BEHAVIORS_HOLD_TAP_IMMEDIATE_INTERRUPT=y
CONFIG_ZMK_BEHAVIORS_HOLD_TAP_STRICT_INTERRUPT=y # Recommended for home row mods
CONFIG_ZMK_BEHAVIORS_HOLD_TAP_PER_KEY_CONFIG=y   # Allows per-behavior tapping-term
CONFIG_ZMK_HOLD_TAP_GLOBAL_TAPPING_TERM_MS=220   # Default tapping term if not set per behavior

# Macros
CONFIG_ZMK_MACROS=y
CONFIG_ZMK_MACRO_MAX_LEN=128
CONFIG_ZMK_MACRO_MAX_MACROS=16

# --- ZMK Studio Support (as per build.yaml and common requirements) ---
CONFIG_ZMK_STUDIO=y
CONFIG_ZMK_STUDIO_LOCKING=n
CONFIG_ZMK_RPC_USB_SERIAL=y # For studio-rpc-usb-uart snippet
CONFIG_UART_CONSOLE=n       # Disable console if USB serial is for RPC
CONFIG_USB_DEVICE_STACK_NEXT=y
CONFIG_USB_DEVICE_PRODUCT="Eyelash Sofle ZMK Studio"
CONFIG_USB_DEVICE_MANUFACTURER="ZMK Project"
CONFIG_ZMK_USB_INIT_PRIORITY=80 # Default, ensure it's compatible with studio needs

# --- Power Management ---
CONFIG_ZMK_PM_SOFT_OFF=y
# From user's README: "Modified power supply mode to reduce power consumption."
# Add any specific power config flags from your original setup if known.
# E.g., CONFIG_ZMK_EXT_POWER_USB_ONLY=y or similar if you have external power control.

# --- Settings Reset ---
# The settings_reset shield usually handles this, but ensure basic flash ops are enabled.
CONFIG_SETTINGS=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_NVS=y

# Increase work queue stack size if experiencing issues with many features
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048 # Default is often 1024 or 2048, can increase if needed
